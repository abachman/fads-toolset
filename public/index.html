<!DOCTYPE html>
<html>
  <head>
    <title>Ruby on Rails: Welcome aboard</title>
    <style type="text/css" media="screen">
    </style>

    <script src='/javascripts/jquery.js'></script>
    <script src='/javascripts/underscore.js'></script>
    <!-- <script src='/javascripts/backbone.js'></script> -->

    <script type="text/javascript">
      /* QUERY
           http://query.yahooapis.com/v1/public/yql?
             q=select%20*%20from%20search.termextract%20where%20context%20%3D%20%22Italian%20sculptors%20and%20painters%20of%20the%20renaissance%20favored%20the%20Virgin%20Mary%20for%20inspiration%22%20and%20query%20%3D%20%22madonna%22&
             format=json&
             diagnostics=true&
             callback=cbfunc

        RESPONSE
          cbfunc({
           "query": {
            "count": 5,
            "created": "2011-02-08T19:13:34Z",
            "lang": "en-US",
            "diagnostics": {
             "publiclyCallable": "true",
             "user-time": "194",
             "service-time": "190",
             "build-version": "10970"
            },
            "results": {
             "Result": [
              "italian sculptors",
              "virgin mary",
              "painters",
              "renaissance",
              "inspiration"
             ]
            }
           }
          });
       */

      function escapeContext(text) {
        return text.
          replace(/"/g, "'").
          replace(/\n/, ' ');
      }

      $(function () {
        $('#yql_termextract_form').submit(function () {
          // get text
          $.getJSON('/gettext', {uri: $("#context_url").val()}, 
            function (data) {
              if (data.status == 'ok') {
                // submit to YQL            
                var query = 'select * from search.termextract where context="<%= page_content %>"';
                  
                // $('<p></p>').text($('#yql_termextract_form').serialize());
                $('#keyword_results').append();
              } else {
                alert("ERROR [" + data.status.error.type + "] " + data.status.error.message);
              }
            }
          );

          // http://query.yahooapis.com/v1/public/yql

          return false;
        });
      });

    </script>
  </head>
  <body>
    <h1>FADS Toolset</h1>

    <h3>Keyword extractor</h3>
    <div>
      <form id='yql_termextract_form' action=''>
        <label for='keyword_query'>Query:</label>
        <input type='text' id='keyword_query' name='keyword_query' />
        <br />
        <label for='context_url'>Context URL</label>
        <input type='text' id='context_url' name='context_url' />
        <br />
        <input type='submit' value='Search' />
      </form>
    </div>
    <div id='keyword_results'></div>
  </body>
</html>
